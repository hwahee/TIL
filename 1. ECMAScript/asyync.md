# 비동기 프로그래밍
ref. from [생활코딩](https://opentutorials.org), [Do it 책](https://book.naver.com/bookdb/book_detail.naver?bid=16275622)


## 비유
빨래, 청소의 집안일이 있다고 했을 때
### 동기
- 빨래를 시작한다
- 빨래가 1시간이 걸려서 끝나면 그 다음 청소를 시작한다. 
- ☆빨래가 끝나기 전에는 가만히 있어도 아무 일도 할 수 없다 
### 비동기
- 빨래를 시작한다
- 세탁기를 가동하고 나면 삘래가 완료되기까지 빨래에 대한 동작을 할 수가 없어진다
- 이때 청소를 시작한다
- 청소가 먼저 끝날지 빨래가 먼저 끝날지는 확실하지 않다


## Node.js에서의 async
- 노드에서는 기본적으로 비동기로 파일 입출력 등 시간(I/O)이 필요한 작업들을 처리하는 것을 권장한다
- 비동기로 처리하는 함수는 콜백 함수를 인자로 받는다. 이는 I/O 등 시간이 걸리는 작업이 처리 완료되었을 경우 그 다음에 실행되어야 하는 것이 붙는 것이다
- 비동기 함수가 실행되자 마자 다음 라인으로 넘어가서 순차적으로 실행한다
- 나머지 라인들을 실행하다가 비동기 함수의 처리가 끝날 때에 함수의 마지막 인자로 줬던 콜백이 실행되는 것이다

### 비동기가 권장되는 이유
js는 단일 스레드로 동작하기 때문에 sync를 시간이 오래 걸리는 처리에 적용하면 처리되는 시간동안 멈추기 때문


## 콜백 지옥
비동기 처리 함수는 콜백이 필요하다. 만약 콜백 함수 내에서도 비동기 처리를 해야 한다면 콜백 함수 내에 비동기 처리와 콜백 함수를 넣게 되고 이것이 계속 반복되면 코드가 복잡해질 것이다
> 콜백 구조가 복잡한 형태로 얽힌 것을 콜백 지옥이라 한다


## Promise
콜백 지옥의 문제를 해결함
- Promise는 콜백 함수를 매개변수로 받는다
- promise 클래스는 정상적으로 실행되었을 때의 resolve, 잘못 실행되었을 때의 reject라는 static method 를 제공한다
- promise.resolve(값)에 처리된 값을 넣으면 그 값은 then() 메서드에서 얻을 수 있다

### then체인 
비동기 처리가 연속으로 진행되어야 하는 경우 Promise를 반환하게 하면 then에 콜백 함수를 주어서 다시 promie를 반환하게 할 수 있다. 이렇게 되면 연속적으로 then(()=>{}).then(()=>{})의 형태가 나오게 된다